# 1.2.1 Relational Database Concepts

## 📋 Section Overview
- **Duration**: 35 minutes
- **Prerequisites**: Basic understanding of data storage concepts
- **Learning Objectives**: 
  - Understand fundamental relational database concepts
  - Learn about tables, rows, columns, and primary keys
  - Grasp the concept of relationships between data
  - Recognize how these concepts apply to Prisma
- **Difficulty Level**: Beginner

---

## 🎯 What You'll Learn

By the end of this section, you will:
- ✅ Explain what relational databases are and why they matter
- ✅ Understand tables, rows, columns, and keys
- ✅ Recognize different types of relationships between data
- ✅ See how Prisma models these database concepts
- ✅ Apply relational thinking to real-world data problems

---

## 📖 Content

### What Are Relational Databases?

A **relational database** is like a well-organized **digital filing cabinet** where information is stored in structured tables that can connect to each other through relationships.

### 🏢 The Office Filing System Analogy

Imagine you're running a **modern office** with perfectly organized filing systems:

```
🏢 Office Database (Your Company)
├── 📋 Employee Files (Users Table)
│   ├── Employee ID, Name, Email, Department
│   └── One file per employee
├── 📁 Project Folders (Projects Table)  
│   ├── Project ID, Name, Deadline, Budget
│   └── One folder per project
├── 📝 Assignment Sheets (ProjectAssignments Table)
│   ├── Links employees to projects
│   └── Shows who works on what
└── 🏷️ Cross-References (Relationships)
    └── Connect related information
```

### 🧱 Core Building Blocks

#### **1. Tables - The Filing Cabinets**

A **table** is like a filing cabinet dedicated to one type of information:

```
👥 Users Table (Employee Filing Cabinet)
┌─────┬─────────────┬─────────────────────┬──────────────┐
│ id  │ name        │ email               │ department   │
├─────┼─────────────┼─────────────────────┼──────────────┤
│ 1   │ Alice Smith │ alice@company.com   │ Engineering  │
│ 2   │ Bob Johnson │ bob@company.com     │ Marketing    │
│ 3   │ Carol Davis │ carol@company.com   │ Engineering  │
└─────┴─────────────┴─────────────────────┴──────────────┘
```

**Table Characteristics:**
- 📋 **Organized Structure**: Each table stores one type of entity
- 📏 **Consistent Format**: All rows have the same columns
- 🏷️ **Named Columns**: Each column has a specific purpose
- 🔢 **Unique Identification**: Each row can be uniquely identified

#### **2. Rows - Individual Records**

A **row** (also called a record) is like an individual file or document:

```
📄 Single User Record (One Employee File)
┌─────────────────────────────────────────┐
│ Employee File #1                        │
├─────────────────────────────────────────┤
│ ID: 1                                   │
│ Name: Alice Smith                       │
│ Email: alice@company.com                │
│ Department: Engineering                 │
│ Hire Date: 2023-01-15                  │
└─────────────────────────────────────────┘
```

#### **3. Columns - Data Categories**

A **column** (also called a field) represents one type of information:

```
📊 Column Types in Users Table

🆔 id (Primary Key)
├── Type: Integer
├── Purpose: Unique identifier
└── Example: 1, 2, 3, 4...

👤 name (Text Field)  
├── Type: String
├── Purpose: Person's full name
└── Example: "Alice Smith", "Bob Johnson"

📧 email (Text Field)
├── Type: String  
├── Purpose: Contact information
└── Example: "alice@company.com"

🏢 department (Text Field)
├── Type: String
├── Purpose: Work division
└── Example: "Engineering", "Marketing"
```

#### **4. Primary Keys - Unique Identifiers**

A **primary key** is like an **employee ID badge** - it uniquely identifies each record:

```
🆔 Primary Key Concept

❌ Without Primary Key (Confusion!)
├── "Alice Smith" - Which Alice? 
├── "John Doe" - We have 3 Johns!
└── "Same email address" - Impossible to distinguish

✅ With Primary Key (Clear!)
├── User #1: Alice Smith (alice@company.com)
├── User #2: Alice Johnson (alice.j@company.com)  
└── User #47: John Doe (john.doe@company.com)
```

**Primary Key Rules:**
- 🔒 **Unique**: No two rows can have the same primary key
- ⚡ **Never Changes**: Remains constant throughout record's life
- 🚫 **Not Null**: Must always have a value
- 🎯 **Simple**: Usually a single column (often auto-incrementing number)

### 🔗 Relationships Between Tables

Real-world data doesn't exist in isolation. Tables connect to each other through **relationships**:

#### **1. One-to-One Relationships (1:1)**

Like **one employee having one parking space**:

```
👤 Users Table          🚗 ParkingSpaces Table
┌────┬───────────┐      ┌────┬─────────┬─────────┐
│ id │ name      │      │ id │ space   │ user_id │
├────┼───────────┤      ├────┼─────────┼─────────┤
│ 1  │ Alice     │ ──── │ 1  │ A-001   │ 1       │
│ 2  │ Bob       │ ──── │ 2  │ A-002   │ 2       │
└────┴───────────┘      └────┴─────────┴─────────┘
     One User               One Parking Space
```

#### **2. One-to-Many Relationships (1:N)**

Like **one department having many employees**:

```
🏢 Departments Table        👥 Users Table
┌────┬─────────────┐       ┌────┬───────┬─────────────┐
│ id │ name        │       │ id │ name  │ dept_id     │
├────┼─────────────┤       ├────┼───────┼─────────────┤
│ 1  │ Engineering │ ───┬─ │ 1  │ Alice │ 1           │
│ 2  │ Marketing   │    ├─ │ 2  │ Bob   │ 1           │
└────┴─────────────┘    ├─ │ 3  │ Carol │ 1           │
     One Department      └─ │ 4  │ Dave  │ 2           │
                            └────┴───────┴─────────────┘
                                 Many Users
```

#### **3. Many-to-Many Relationships (M:N)**

Like **employees working on multiple projects, and projects having multiple employees**:

```
👥 Users Table          📋 Projects Table
┌────┬───────┐          ┌────┬──────────┐
│ id │ name  │          │ id │ name     │
├────┼───────┤          ├────┼──────────┤
│ 1  │ Alice │          │ 1  │ Website  │
│ 2  │ Bob   │          │ 2  │ Mobile   │
└────┴───────┘          └────┴──────────┘
      │                        │
      └────────┬─────────────────┘
               │
    📝 UserProjects Table (Junction Table)
    ┌─────────┬────────────┬──────────┐
    │ user_id │ project_id │ role     │
    ├─────────┼────────────┼──────────┤
    │ 1       │ 1          │ Lead     │
    │ 1       │ 2          │ Developer│
    │ 2       │ 1          │ Designer │
    └─────────┴────────────┴──────────┘
```

### 🎯 How Prisma Models These Concepts

#### **Prisma Schema Representation**

```prisma
// schema.prisma - Modeling our office example

model User {
  id           Int           @id @default(autoincrement())
  email        String        @unique
  name         String
  department   Department    @relation(fields: [departmentId], references: [id])
  departmentId Int
  
  // One-to-One: User has one parking space
  parkingSpace ParkingSpace?
  
  // Many-to-Many: User works on many projects
  projects     UserProject[]
  
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model Department {
  id    Int    @id @default(autoincrement())
  name  String @unique
  
  // One-to-Many: Department has many users
  users User[]
}

model ParkingSpace {
  id     Int  @id @default(autoincrement())
  space  String @unique
  user   User @relation(fields: [userId], references: [id])
  userId Int  @unique  // This makes it One-to-One
}

model Project {
  id    Int    @id @default(autoincrement())
  name  String
  
  // Many-to-Many: Project has many users
  users UserProject[]
}

model UserProject {
  id        Int     @id @default(autoincrement())
  user      User    @relation(fields: [userId], references: [id])
  userId    Int
  project   Project @relation(fields: [projectId], references: [id])
  projectId Int
  role      String  // Additional data in the relationship
  
  @@unique([userId, projectId]) // Prevent duplicate assignments
}
```

#### **Generated TypeScript Types**

```typescript
// Prisma automatically generates these types
type User = {
  id: number;
  email: string;
  name: string;
  departmentId: number;
  createdAt: Date;
  updatedAt: Date;
}

type UserWithRelations = User & {
  department: Department;
  parkingSpace?: ParkingSpace;
  projects: (UserProject & {
    project: Project;
  })[];
}
```

### 🔍 Real-World Data Modeling

#### **E-commerce Example**

```
🛒 E-commerce Database Structure

📊 Products Table
├── id, name, price, description
├── categoryId (links to Categories)
└── supplierId (links to Suppliers)

👥 Customers Table  
├── id, email, name, address
└── Primary key: id

🛍️ Orders Table
├── id, customerId, total, status
├── Links to: Customer (who ordered)
└── Contains: Many order items

📦 OrderItems Table (Junction)
├── orderId, productId, quantity, price
├── Links: Order ↔ Product
└── Stores: Additional data (quantity, price at time of order)

🏷️ Categories Table
├── id, name, description
└── Links to: Many products

🏭 Suppliers Table  
├── id, name, contact_info
└── Links to: Many products
```

#### **Prisma Schema for E-commerce**

```prisma
model Customer {
  id     Int     @id @default(autoincrement())
  email  String  @unique
  name   String
  orders Order[]
}

model Product {
  id          Int         @id @default(autoincrement())
  name        String
  price       Decimal
  category    Category    @relation(fields: [categoryId], references: [id])
  categoryId  Int
  orderItems  OrderItem[]
}

model Order {
  id         Int         @id @default(autoincrement())
  customer   Customer    @relation(fields: [customerId], references: [id])
  customerId Int
  total      Decimal
  items      OrderItem[]
  createdAt  DateTime    @default(now())
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  order     Order   @relation(fields: [orderId], references: [id])
  orderId   Int
  product   Product @relation(fields: [productId], references: [id])
  productId Int
  quantity  Int
  price     Decimal // Price at time of purchase
  
  @@unique([orderId, productId])
}

model Category {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  products Product[]
}
```

### 💡 Best Practices for Relational Design

#### **1. Normalization Principles**

**Avoid Data Duplication:**
```
❌ Bad Design (Repeated Data)
Orders Table:
┌─────┬──────────────┬─────────────────┬─────────────┐
│ id  │ customer_name│ customer_email  │ total       │
├─────┼──────────────┼─────────────────┼─────────────┤
│ 1   │ Alice Smith  │ alice@email.com │ 150.00      │
│ 2   │ Alice Smith  │ alice@email.com │ 75.50       │
└─────┴──────────────┴─────────────────┴─────────────┘
     Duplicated customer information!

✅ Good Design (Normalized)
Customers Table:
┌─────┬─────────────┬─────────────────┐
│ id  │ name        │ email           │
├─────┼─────────────┼─────────────────┤
│ 1   │ Alice Smith │ alice@email.com │
└─────┴─────────────┴─────────────────┘

Orders Table:
┌─────┬─────────────┬─────────┐
│ id  │ customer_id │ total   │
├─────┼─────────────┼─────────┤
│ 1   │ 1           │ 150.00  │
│ 2   │ 1           │ 75.50   │
└─────┴─────────────┴─────────┘
     Clean, no duplication!
```

#### **2. Meaningful Relationships**

**Think About Real-World Connections:**
- 👤 **User** → 📧 **Email**: One-to-One (one primary email)
- 🏢 **Department** → 👥 **Employees**: One-to-Many (many employees per department)
- 📚 **Students** ↔ 📖 **Courses**: Many-to-Many (students take multiple courses, courses have multiple students)

---

## 🧠 Knowledge Check

### Quick Quiz

1. **What is a primary key's main purpose?**
   - [ ] A) To store the most important data
   - [x] B) To uniquely identify each row in a table
   - [ ] C) To connect tables together
   - [ ] D) To make queries faster

   **Explanation**: A primary key serves as a unique identifier for each row, ensuring no two rows can have the same primary key value.

2. **In a One-to-Many relationship, where does the foreign key go?**
   - [ ] A) In the "One" side table
   - [x] B) In the "Many" side table
   - [ ] C) In a separate junction table
   - [ ] D) In both tables

   **Explanation**: The foreign key goes in the "Many" side table, pointing back to the primary key of the "One" side table.

3. **What type of relationship requires a junction table?**
   - [ ] A) One-to-One
   - [ ] B) One-to-Many
   - [x] C) Many-to-Many
   - [ ] D) None of the above

   **Explanation**: Many-to-Many relationships require a junction table to store the connections between the two entities.

### Relationship Identification

**Identify the relationship type for each scenario:**

| Scenario | Relationship Type |
|----------|------------------|
| Person → Passport | _________ |
| Author → Books | _________ |
| Students ↔ Classes | _________ |
| Order → Order Items | _________ |

**Answers**: One-to-One, One-to-Many, Many-to-Many, One-to-Many

### Schema Design Exercise

**Design a simple schema for a library system:**

**Entities needed:**
- Books
- Authors  
- Members
- Borrowing records

**Your Schema Design:**
```
Books: ________________
Authors: ________________
Members: ________________
Borrowings: ________________
```

**Sample Answer:**
```
Books: id, title, isbn, authorId
Authors: id, name, bio
Members: id, name, email, membershipDate
Borrowings: id, bookId, memberId, borrowDate, returnDate
```

---

## 💡 Key Takeaways

- 🏢 **Tables Structure Data**: Like organized filing cabinets for different types of information
- 🆔 **Primary Keys Identify**: Unique identifiers prevent confusion and enable relationships
- 🔗 **Relationships Connect**: One-to-One, One-to-Many, and Many-to-Many model real-world connections
- 🎯 **Normalization Prevents Duplication**: Store data once, reference it many times
- 📊 **Prisma Models Concepts**: Schema.prisma provides a clean way to define tables and relationships
- 🔧 **Design Reflects Reality**: Good database design mirrors real-world business relationships

---

## 🔗 Navigation

**📍 Current Location**: Module 1 → Section 1.2 → Lesson 1.2.1

**⬅️ Previous**: [1.1.5 Use Cases and When to Choose Prisma](../1.1-what-is-prisma/1.1.5-use-cases-and-when-to-choose-prisma.md)
**➡️ Next**: [1.2.2 SQL Fundamentals](./1.2.2-sql-fundamentals.md)

**🏠 Section Home**: [1.2 Database Fundamentals](./README.md)
**📚 Module Home**: [Module 1: Foundations](../01-foundations.md)

**🗺️ Quick Links**:
- [Previous Section: What is Prisma](../1.1-what-is-prisma/)
- [Next: SQL Fundamentals](./1.2.2-sql-fundamentals.md)
- [Jump to: Schema Design](../1.3-schema-design/)

---

*Ready to learn about SQL and how it works with relational databases? Continue to the next lesson!*
